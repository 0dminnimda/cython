PYTHON setup.py build_ext --inplace

######## setup.py ###########

import sys
from distutils.core import setup

import Cython.Compiler.Scanning
from Cython.Build import cythonize

Cython.Compiler.Scanning.trace_scanner = 1

setup(ext_modules=cythonize("*.pyx"))

if sys.platform == 'win32' or sys.version_info < (3, 5):
    # Try to import from the current directory.
    import os, sys
    sys.path.insert(0, os.getcwd())
    import simple
else:
    from importlib.util import spec_from_file_location, module_from_spec
    import glob
    ext_files = glob.glob("simple*.so") + glob.glob("simple*.pyd")
    assert ext_files
    spec = spec_from_file_location('simple', ext_files[0])
    simple = module_from_spec(spec)
    spec.loader.exec_module(simple)


assert simple.test() == 123


######## simple.pyx ###########

def test():
    return 123


ci-run.sh: add flags to BASE_CFLAGS